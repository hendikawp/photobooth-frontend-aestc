import{x,y as L,z as P,A as B,d as $,b as u,e as a,F as V,B as z,n as _,s as r,v as t,C as T,Q as v,D as H,E as q,p as l,G as p,H as k,I as C,J as G,K as F,q as n,L as D,r as w,g as K,h as X,M as Y,c as E,N as W,k as J,_ as N}from"./index-BQ1gfdb-.js";import{Q as b}from"./QPageSticky-BQmq18Rh.js";import{Q as U}from"./QPage-hU3tkQfe.js";import{_ as Z,a as ee}from"./PreviewStream.vue_vue_type_style_index_0_lang-CCUY5QWM.js";import{Q as te}from"./QImg-1NoyfuxY.js";import{Q as ie}from"./QBadge-CI-X3YZv.js";import{I as oe}from"./ItemNotAvailableError-DFYa2LK9.js";import"./QCircularProgress-DEx_ZwD9.js";import"./format-CJebrXOQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',ne=x({name:"QSpinnerGrid",props:L,setup(y){const{cSize:e,classes:o}=P(y);return()=>B("svg",{class:o.value,fill:"currentColor",width:e.value,height:e.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:ae})}}),se='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',re=x({name:"QSpinnerPuff",props:L,setup(y){const{cSize:e,classes:o}=P(y);return()=>B("svg",{class:o.value,stroke:"currentColor",width:e.value,height:e.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:se})}}),le={class:"row q-gutter-md action-buttons"},ce={style:{"white-space":"nowrap"},class:"gt-sm"},ue=$({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(y,{emit:e}){const o=e;function h(m,s){o("triggerAction",m,s)}return(m,s)=>(a(),u("div",le,[(a(!0),u(V,null,z(m.triggers,(i,g)=>(a(),u("div",{key:g},[i.show_button&&!(t(T.isEmpty)(i.title)&&t(T.isEmpty)(i.icon))?(a(),_(v,{key:0,stack:"",color:i.use_custom_color?"custom":"primary","no-caps":"",rounded:"",class:q(["action-button col-auto glass-effect",["action-button-"+g]]),style:H({"--bg-custom":i.use_custom_color?i.custom_color:null}),onClick:I=>h(i.action,i.config_index)},{default:l(()=>[t(T.isEmpty)(i.icon)?r("",!0):(a(),_(k,{key:0,name:`sym_o_${i.icon}`},null,8,["name"])),p("div",ce,C(i.title),1)]),_:2},1032,["color","class","style","onClick"])):r("",!0)]))),128))]))}}),me={id:"itemapproval-dialog",class:"absolute-full flex flex-center"},de={class:"q-mb-lg action-buttons col"},_e={class:"q-mb-sm row flex flex-center"},pe={class:"row"},ge=$({__name:"MediaItemApprovalViewer",props:{approval_id:{},number_captures_taken:{},total_captures_to_take:{}},setup(y){const e=G(!0);F(()=>{e.value=!0});const o=()=>{w("/api/processing/confirm")},h=()=>{w("/api/processing/reject")},m=async()=>{try{await w("/api/processing/abort"),window.location.href="/"}catch(s){console.error("Abort failed:",s)}};return(s,i)=>(a(),u("div",me,[e.value?(a(),_(te,{key:0,draggable:!1,loading:"eager",src:`/api/processing/approval/${s.approval_id}`,fit:"contain",style:{height:"95%"},onError:i[0]||(i[0]=g=>e.value=!1),"loading-show-delay":"800"},null,8,["src"])):(a(),_(oe,{key:1})),n(b,{position:"top-left",class:"q-ma-lg"},{default:l(()=>[n(v,{id:"layout-button-back",color:"grey",rounded:"","no-caps":"",onClick:i[1]||(i[1]=g=>m()),class:"action-button glass-effect"},{default:l(()=>[n(k,{left:"",name:"sym_o_cancel"}),p("div",null,C(s.$t("MSG_APPROVE_COLLAGE_ITEM_CANCEL_COLLAGE")),1)]),_:1})]),_:1}),n(b,{position:"bottom",class:"q-ma-lg"},{default:l(()=>[p("div",de,[p("div",_e,[n(ie,{color:"grey-8",class:"q-mr-xs"},{default:l(()=>[n(k,{name:"sym_o_tag",color:"white",class:"q-mr-xs"}),D(" "+C(s.$t("LABEL_ELEMENT_X_OF_Y",{no:s.number_captures_taken,total:s.total_captures_to_take})),1)]),_:1})]),p("div",pe,[n(v,{id:"item-approval-button-reject",stack:"",rounded:"",class:"q-mr-lg action-button col-auto glass-effect",color:"negative","no-caps":"",icon:"sym_o_thumb_down",label:s.$t("MSG_APPROVE_COLLAGE_ITEM_RETRY"),onClick:i[2]||(i[2]=g=>h())},null,8,["label"]),n(v,{id:"item-approval-button-approve",stack:"",rounded:"",class:"q-mr-sm action-button col-auto glass-effect",color:"positive","no-caps":"",icon:"sym_o_thumb_up",label:s.$t("MSG_APPROVE_COLLAGE_ITEM_APPROVE"),onClick:i[3]||(i[3]=g=>o())},null,8,["label"])])])]),_:1})]))}}),fe={key:1,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},be={key:2,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},ve=["innerHTML"],ye={key:4},he={key:0},ke={key:0},Ce={class:"q-gutter-md"},we={class:"gt-sm"},Se={key:0},Ee={class:"q-gutter-md"},Ae={class:"gt-sm"},Ge=$({__name:"IndexPage",setup(y){const e=K(),o=X(),h=J(),m=G(0);Y(m,()=>{m.value>=5&&h.push("/admin"),m.value=0},{debounce:500});const s=E(()=>{const c=[];return Object.entries(o.configuration.actions).forEach(([d,S])=>{S.forEach((f,A)=>{const M={action:`actions/${d}`,config_index:A,show_button:f.trigger.ui_trigger.show_button,title:f.trigger.ui_trigger.title,icon:f.trigger.ui_trigger.icon,use_custom_color:f.trigger.ui_trigger.use_custom_color,custom_color:f.trigger.ui_trigger.custom_color};c.push(M)})}),c}),i=E(()=>o.configuration.uisettings.admin_button_invisible),g=E(()=>{const c=o.configuration.uisettings.enable_livestream_when_idle,d=o.configuration.uisettings.enable_livestream_when_active,S=e.isStateIdle,f=e.isStateRecording,A=e.isStateCountdown,M=e.isStateCapture;return S&&c||(A||M)&&d||f}),I=W(g,500),Q=E(()=>{const c=N.get(e.jobmodel.configuration_set,"processing.img_frame_enable",!1),d=N.get(e.jobmodel.configuration_set,"processing.img_frame_file","");return e.isStateCountdown&&c?d:e.isStateIdle&&o.configuration.uisettings.enable_livestream_frameoverlay?o.configuration.uisettings.livestream_frameoverlay_image:""}),R=()=>{i.value?m.value++:h.push("/admin")},O=(c,d)=>{w(`/api/${c}/${d}`)},j=()=>{w("/api/processing/next")};return(c,d)=>(a(),_(U,{id:"index-page",class:"q-pa-none full-height"},{default:l(()=>[t(I)?(a(),_(Z,{key:0,"frame-overlay-image":Q.value,"enable-blurred-background-stream":t(o).configuration.uisettings.livestream_blurredbackground,"enable-mirror-effect-stream":t(o).configuration.uisettings.livestream_mirror_effect,"enable-mirror-effect-frame":t(o).configuration.uisettings.livestream_frameoverlay_mirror_effect},null,8,["frame-overlay-image","enable-blurred-background-stream","enable-mirror-effect-stream","enable-mirror-effect-frame"])):r("",!0),t(e).isStateProcessing?(a(),u("div",fe,[n(ne,{size:"20em"})])):r("",!0),t(e).isStateCountdown?(a(),u("div",be,[n(ee,{ref:"countdowntimer",duration:t(e).jobmodel.duration,"message-duration":t(o).configuration.uisettings.TAKEPIC_MSG_TIME,"message-text":t(o).configuration.uisettings.TAKEPIC_MSG_TEXT},null,8,["duration","message-duration","message-text"])])):r("",!0),t(e).isStateIdle?(a(),u("div",{key:3,id:"frontpage_text",innerHTML:t(o).configuration.uisettings.FRONTPAGE_TEXT},null,8,ve)):r("",!0),t(e).isStateApproval?(a(),u("div",ye,[n(ge,{approval_id:t(e).jobmodel.approval_id,number_captures_taken:t(e).jobmodel.number_captures_taken,total_captures_to_take:t(e).jobmodel.total_captures_to_take},null,8,["approval_id","number_captures_taken","total_captures_to_take"])])):r("",!0),n(b,{position:"bottom",class:"q-mb-lg"},{default:l(()=>[t(e).isStateIdle?(a(),u("div",he,[n(ue,{triggers:s.value,onTriggerAction:O},null,8,["triggers"])])):r("",!0)]),_:1}),n(b,{position:"top-left",class:"q-ma-lg"},{default:l(()=>[t(e).isStateIdle?(a(),u("div",ke,[p("div",Ce,[t(o).configuration.uisettings.show_gallery_on_frontpage?(a(),_(v,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button glass-effect"},{default:l(()=>[n(k,{left:"",name:"sym_o_photo_library"}),p("div",we,C(c.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1})):r("",!0)])])):r("",!0)]),_:1}),n(b,{position:"top-right",class:"q-ma-lg"},{default:l(()=>[t(e).isStateIdle?(a(),u("div",Se,[p("div",Ee,[t(o).configuration.uisettings.show_admin_on_frontpage?(a(),_(v,{key:0,id:"frontpage-button-to-admin",rounded:"",color:"transparent","no-caps":"",class:q(["action-button action-button-admin glass-effect",{"action-button-admin-invisible":i.value}]),onClick:R},{default:l(()=>[n(k,{left:"",name:"sym_o_admin_panel_settings"}),p("div",Ae,C(c.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1},8,["class"])):r("",!0)])])):r("",!0)]),_:1}),t(e).isStateRecording?(a(),_(b,{key:5,id:"frontpage-indicator-recording",position:"top-right",offset:[25,25],align:"center"},{default:l(()=>[n(re,{color:"red",size:"12em",thickness:"20"})]),_:1})):r("",!0),t(e).isStateRecording?(a(),_(b,{key:6,id:"frontpage-indicator-stop-recording",position:"bottom",offset:[0,25],align:"center"},{default:l(()=>[n(v,{stack:"",rounded:"","no-caps":"",color:"negative",class:"action-button glass-effect",onClick:d[0]||(d[0]=S=>j())},{default:l(()=>[n(k,{name:"sym_o_stop_circle"}),p("div",null,C(c.$t("Stop recording")),1)]),_:1})]),_:1})):r("",!0)]),_:1}))}});export{Ge as default};
